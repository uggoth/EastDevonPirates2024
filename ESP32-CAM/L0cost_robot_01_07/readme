Consolidated version for PiWars submission
